create table if not exists public.roles
(
    id   integer generated by default as identity
        primary key,
    name varchar(255)
);

alter table public.roles
    owner to postgres;

create table if not exists public.users
(
    birth_date        date,
    is_active         boolean,
    id                bigint generated by default as identity
        primary key,
    registration_date timestamp(6),
    email             varchar(255) not null
        unique,
    first_name        varchar(255),
    last_name         varchar(255),
    password          varchar(255) not null,
    phone_number      varchar(255),
    team_name         varchar(255)
);

alter table public.users
    owner to postgres;

create table if not exists public.password_reset_token
(
    attempts    integer not null,
    used        boolean not null,
    created_at  timestamp(6),
    expiry_date timestamp(6),
    id          bigint generated by default as identity
        primary key,
    user_id     bigint
        constraint fk83nsrttkwkb6ym0anu051mtxn
            references public.users,
    code        varchar(255),
    email       varchar(255),
    token       varchar(255)
);

alter table public.password_reset_token
    owner to postgres;

create table if not exists public.tournament
(
    max_categories_to_play integer,
    max_players            integer,
    registration_closed    boolean,
    creator_id             bigint
        constraint fkst1687lj5p99arqj9qbahk7ci
            references public.users,
    date_of_tournament     timestamp(6) not null,
    id                     bigint generated by default as identity
        primary key,
    registration_expired   timestamp(6) not null,
    description            text,
    entry_fee              varchar(255),
    location               varchar(255),
    name_tournament        varchar(255) not null,
    url_tournament         varchar(255)
);

alter table public.tournament
    owner to postgres;

create table if not exists public.export_history
(
    export_count    bigint,
    id              bigint generated by default as identity
        primary key,
    stamp_of_export timestamp(6),
    tournament_id   bigint       not null
        constraint fkjhu9y0fg91v8ie3qn8qgtp24i
            references public.tournament,
    user_id         bigint       not null
        constraint fkq5csph86l3lwd8294dm0vi4f5
            references public.users,
    export_type     varchar(255) not null
        constraint export_history_export_type_check
            check ((export_type)::text = ANY
                   ((ARRAY ['FULL'::character varying, 'NEW_REGISTERED'::character varying, 'RANGED_REGISTERED'::character varying])::text[])),
    notes           varchar(255)
);

alter table public.export_history
    owner to postgres;

create table if not exists public.partnership
(
    created_at    timestamp(6) not null,
    id            bigint generated by default as identity
        primary key,
    player1_id    bigint       not null
        constraint fks5cm5x3yuiob0bcemv6sid1x4
            references public.users,
    player2_id    bigint       not null
        constraint fk5y8hphb08mb5blqw41t376ur2
            references public.users,
    responded_at  timestamp(6),
    tournament_id bigint       not null
        constraint fkks56f4phaplcg1q1dowpcm4vu
            references public.tournament,
    category      varchar(255) not null
        constraint partnership_category_check
            check ((category)::text = ANY
                   ((ARRAY ['MS_U11'::character varying, 'MS_U13'::character varying, 'MS_U15'::character varying, 'MS_U17'::character varying, 'MS_U19'::character varying, 'MS_U21'::character varying, 'MS_U23'::character varying, 'WS_U11'::character varying, 'WS_U13'::character varying, 'WS_U15'::character varying, 'WS_U17'::character varying, 'WS_U19'::character varying, 'WS_U21'::character varying, 'WS_U23'::character varying, 'MD_U11'::character varying, 'MD_U13'::character varying, 'MD_U15'::character varying, 'MD_U17'::character varying, 'MD_U19'::character varying, 'MD_U21'::character varying, 'MD_U23'::character varying, 'WD_U11'::character varying, 'WD_U13'::character varying, 'WD_U15'::character varying, 'WD_U17'::character varying, 'WD_U19'::character varying, 'WD_U21'::character varying, 'WD_U23'::character varying, 'XD_U11'::character varying, 'XD_U13'::character varying, 'XD_U15'::character varying, 'XD_U17'::character varying, 'XD_U19'::character varying, 'XD_U21'::character varying, 'XD_U23'::character varying, 'MS_OPEN'::character varying, 'MS_A'::character varying, 'MS_B'::character varying, 'MS_C'::character varying, 'WS_OPEN'::character varying, 'WS_A'::character varying, 'WS_B'::character varying, 'WS_C'::character varying, 'MD_OPEN'::character varying, 'MD_A'::character varying, 'MD_B'::character varying, 'MD_C'::character varying, 'WD_OPEN'::character varying, 'WD_A'::character varying, 'WD_B'::character varying, 'WD_C'::character varying, 'XD_OPEN'::character varying, 'XD_A'::character varying, 'XD_B'::character varying, 'XD_C'::character varying, 'MS_18PLUS'::character varying, 'MS_30PLUS'::character varying, 'MS_40PLUS'::character varying, 'MS_50PLUS'::character varying, 'MS_60PLUS'::character varying, 'MS_70PLUS'::character varying, 'WS_18PLUS'::character varying, 'WS_30PLUS'::character varying, 'WS_40PLUS'::character varying, 'WS_50PLUS'::character varying, 'WS_60PLUS'::character varying, 'WS_70PLUS'::character varying, 'MD_18PLUS'::character varying, 'MD_30PLUS'::character varying, 'MD_40PLUS'::character varying, 'MD_50PLUS'::character varying, 'MD_60PLUS'::character varying, 'MD_70PLUS'::character varying, 'WD_18PLUS'::character varying, 'WD_30PLUS'::character varying, 'WD_40PLUS'::character varying, 'WD_50PLUS'::character varying, 'WD_60PLUS'::character varying, 'WD_70PLUS'::character varying, 'XD_18PLUS'::character varying, 'XD_30PLUS'::character varying, 'XD_40PLUS'::character varying, 'XD_50PLUS'::character varying, 'XD_60PLUS'::character varying, 'XD_70PLUS'::character varying])::text[])),
    status        varchar(255) not null
        constraint partnership_status_check
            check ((status)::text = ANY
                   ((ARRAY ['PENDING'::character varying, 'CONFIRMED'::character varying, 'DECLINED'::character varying, 'CANCELLED'::character varying, 'EXPIRED'::character varying])::text[]))
);

alter table public.partnership
    owner to postgres;

create table if not exists public.tournament_categories
(
    tournament_id bigint not null
        constraint fkpetx36afnykja0gl7ok6wa6qt
            references public.tournament,
    category      varchar(255)
        constraint tournament_categories_category_check
            check ((category)::text = ANY
                   ((ARRAY ['MS_U11'::character varying, 'MS_U13'::character varying, 'MS_U15'::character varying, 'MS_U17'::character varying, 'MS_U19'::character varying, 'MS_U21'::character varying, 'MS_U23'::character varying, 'WS_U11'::character varying, 'WS_U13'::character varying, 'WS_U15'::character varying, 'WS_U17'::character varying, 'WS_U19'::character varying, 'WS_U21'::character varying, 'WS_U23'::character varying, 'MD_U11'::character varying, 'MD_U13'::character varying, 'MD_U15'::character varying, 'MD_U17'::character varying, 'MD_U19'::character varying, 'MD_U21'::character varying, 'MD_U23'::character varying, 'WD_U11'::character varying, 'WD_U13'::character varying, 'WD_U15'::character varying, 'WD_U17'::character varying, 'WD_U19'::character varying, 'WD_U21'::character varying, 'WD_U23'::character varying, 'XD_U11'::character varying, 'XD_U13'::character varying, 'XD_U15'::character varying, 'XD_U17'::character varying, 'XD_U19'::character varying, 'XD_U21'::character varying, 'XD_U23'::character varying, 'MS_OPEN'::character varying, 'MS_A'::character varying, 'MS_B'::character varying, 'MS_C'::character varying, 'WS_OPEN'::character varying, 'WS_A'::character varying, 'WS_B'::character varying, 'WS_C'::character varying, 'MD_OPEN'::character varying, 'MD_A'::character varying, 'MD_B'::character varying, 'MD_C'::character varying, 'WD_OPEN'::character varying, 'WD_A'::character varying, 'WD_B'::character varying, 'WD_C'::character varying, 'XD_OPEN'::character varying, 'XD_A'::character varying, 'XD_B'::character varying, 'XD_C'::character varying, 'MS_18PLUS'::character varying, 'MS_30PLUS'::character varying, 'MS_40PLUS'::character varying, 'MS_50PLUS'::character varying, 'MS_60PLUS'::character varying, 'MS_70PLUS'::character varying, 'WS_18PLUS'::character varying, 'WS_30PLUS'::character varying, 'WS_40PLUS'::character varying, 'WS_50PLUS'::character varying, 'WS_60PLUS'::character varying, 'WS_70PLUS'::character varying, 'MD_18PLUS'::character varying, 'MD_30PLUS'::character varying, 'MD_40PLUS'::character varying, 'MD_50PLUS'::character varying, 'MD_60PLUS'::character varying, 'MD_70PLUS'::character varying, 'WD_18PLUS'::character varying, 'WD_30PLUS'::character varying, 'WD_40PLUS'::character varying, 'WD_50PLUS'::character varying, 'WD_60PLUS'::character varying, 'WD_70PLUS'::character varying, 'XD_18PLUS'::character varying, 'XD_30PLUS'::character varying, 'XD_40PLUS'::character varying, 'XD_50PLUS'::character varying, 'XD_60PLUS'::character varying, 'XD_70PLUS'::character varying])::text[]))
);

alter table public.tournament_categories
    owner to postgres;

create table if not exists public.tournament_category_prices
(
    price         numeric(38, 2) not null,
    id            bigint generated by default as identity
        primary key,
    tournament_id bigint         not null
        constraint fkb0uhauxu23c5i1b55i5wkh0x6
            references public.tournament,
    category      varchar(255)   not null
        constraint tournament_category_prices_category_check
            check ((category)::text = ANY
                   ((ARRAY ['MS_U11'::character varying, 'MS_U13'::character varying, 'MS_U15'::character varying, 'MS_U17'::character varying, 'MS_U19'::character varying, 'MS_U21'::character varying, 'MS_U23'::character varying, 'WS_U11'::character varying, 'WS_U13'::character varying, 'WS_U15'::character varying, 'WS_U17'::character varying, 'WS_U19'::character varying, 'WS_U21'::character varying, 'WS_U23'::character varying, 'MD_U11'::character varying, 'MD_U13'::character varying, 'MD_U15'::character varying, 'MD_U17'::character varying, 'MD_U19'::character varying, 'MD_U21'::character varying, 'MD_U23'::character varying, 'WD_U11'::character varying, 'WD_U13'::character varying, 'WD_U15'::character varying, 'WD_U17'::character varying, 'WD_U19'::character varying, 'WD_U21'::character varying, 'WD_U23'::character varying, 'XD_U11'::character varying, 'XD_U13'::character varying, 'XD_U15'::character varying, 'XD_U17'::character varying, 'XD_U19'::character varying, 'XD_U21'::character varying, 'XD_U23'::character varying, 'MS_OPEN'::character varying, 'MS_A'::character varying, 'MS_B'::character varying, 'MS_C'::character varying, 'WS_OPEN'::character varying, 'WS_A'::character varying, 'WS_B'::character varying, 'WS_C'::character varying, 'MD_OPEN'::character varying, 'MD_A'::character varying, 'MD_B'::character varying, 'MD_C'::character varying, 'WD_OPEN'::character varying, 'WD_A'::character varying, 'WD_B'::character varying, 'WD_C'::character varying, 'XD_OPEN'::character varying, 'XD_A'::character varying, 'XD_B'::character varying, 'XD_C'::character varying, 'MS_18PLUS'::character varying, 'MS_30PLUS'::character varying, 'MS_40PLUS'::character varying, 'MS_50PLUS'::character varying, 'MS_60PLUS'::character varying, 'MS_70PLUS'::character varying, 'WS_18PLUS'::character varying, 'WS_30PLUS'::character varying, 'WS_40PLUS'::character varying, 'WS_50PLUS'::character varying, 'WS_60PLUS'::character varying, 'WS_70PLUS'::character varying, 'MD_18PLUS'::character varying, 'MD_30PLUS'::character varying, 'MD_40PLUS'::character varying, 'MD_50PLUS'::character varying, 'MD_60PLUS'::character varying, 'MD_70PLUS'::character varying, 'WD_18PLUS'::character varying, 'WD_30PLUS'::character varying, 'WD_40PLUS'::character varying, 'WD_50PLUS'::character varying, 'WD_60PLUS'::character varying, 'WD_70PLUS'::character varying, 'XD_18PLUS'::character varying, 'XD_30PLUS'::character varying, 'XD_40PLUS'::character varying, 'XD_50PLUS'::character varying, 'XD_60PLUS'::character varying, 'XD_70PLUS'::character varying])::text[]))
);

alter table public.tournament_category_prices
    owner to postgres;

create table if not exists public.tournament_moderators
(
    tournament_id bigint not null
        constraint fkqbckkugkjjn8t7gealppiec3r
            references public.tournament,
    user_id       bigint not null
        constraint fk56b8yk03wddtk46e4hnpuxkhp
            references public.users,
    primary key (tournament_id, user_id)
);

alter table public.tournament_moderators
    owner to postgres;

create table if not exists public.user_tournament
(
    is_paid           boolean,
    total_fee         double precision,
    id                bigint generated by default as identity
        primary key,
    registration_time timestamp(6),
    tournament_id     bigint                not null
        constraint fknsv2bawu6sxu7dlcuxh2fi816
            references public.tournament,
    user_id           bigint                not null
        constraint fkh2vtyvre1ad7i75pdox6605ph
            references public.users,
    admin_notes       varchar(255),
    status            varchar(255)
        constraint user_tournament_status_check
            check ((status)::text = ANY
                   ((ARRAY ['PENDING'::character varying, 'APPROVED'::character varying, 'REJECTED'::character varying])::text[])),
    is_downloaded     boolean default false not null
);

alter table public.user_tournament
    owner to postgres;

create table if not exists public.registered_category
(
    is_downloaded      boolean not null,
    id                 bigint generated by default as identity
        primary key,
    user_tournament_id bigint
        constraint fk9s167cg7altrmvgh24vhukxda
            references public.user_tournament,
    game_category      varchar(255)
        constraint registered_category_game_category_check
            check ((game_category)::text = ANY
                   ((ARRAY ['MS_U11'::character varying, 'MS_U13'::character varying, 'MS_U15'::character varying, 'MS_U17'::character varying, 'MS_U19'::character varying, 'MS_U21'::character varying, 'MS_U23'::character varying, 'WS_U11'::character varying, 'WS_U13'::character varying, 'WS_U15'::character varying, 'WS_U17'::character varying, 'WS_U19'::character varying, 'WS_U21'::character varying, 'WS_U23'::character varying, 'MD_U11'::character varying, 'MD_U13'::character varying, 'MD_U15'::character varying, 'MD_U17'::character varying, 'MD_U19'::character varying, 'MD_U21'::character varying, 'MD_U23'::character varying, 'WD_U11'::character varying, 'WD_U13'::character varying, 'WD_U15'::character varying, 'WD_U17'::character varying, 'WD_U19'::character varying, 'WD_U21'::character varying, 'WD_U23'::character varying, 'XD_U11'::character varying, 'XD_U13'::character varying, 'XD_U15'::character varying, 'XD_U17'::character varying, 'XD_U19'::character varying, 'XD_U21'::character varying, 'XD_U23'::character varying, 'MS_OPEN'::character varying, 'MS_A'::character varying, 'MS_B'::character varying, 'MS_C'::character varying, 'WS_OPEN'::character varying, 'WS_A'::character varying, 'WS_B'::character varying, 'WS_C'::character varying, 'MD_OPEN'::character varying, 'MD_A'::character varying, 'MD_B'::character varying, 'MD_C'::character varying, 'WD_OPEN'::character varying, 'WD_A'::character varying, 'WD_B'::character varying, 'WD_C'::character varying, 'XD_OPEN'::character varying, 'XD_A'::character varying, 'XD_B'::character varying, 'XD_C'::character varying, 'MS_18PLUS'::character varying, 'MS_30PLUS'::character varying, 'MS_40PLUS'::character varying, 'MS_50PLUS'::character varying, 'MS_60PLUS'::character varying, 'MS_70PLUS'::character varying, 'WS_18PLUS'::character varying, 'WS_30PLUS'::character varying, 'WS_40PLUS'::character varying, 'WS_50PLUS'::character varying, 'WS_60PLUS'::character varying, 'WS_70PLUS'::character varying, 'MD_18PLUS'::character varying, 'MD_30PLUS'::character varying, 'MD_40PLUS'::character varying, 'MD_50PLUS'::character varying, 'MD_60PLUS'::character varying, 'MD_70PLUS'::character varying, 'WD_18PLUS'::character varying, 'WD_30PLUS'::character varying, 'WD_40PLUS'::character varying, 'WD_50PLUS'::character varying, 'WD_60PLUS'::character varying, 'WD_70PLUS'::character varying, 'XD_18PLUS'::character varying, 'XD_30PLUS'::character varying, 'XD_40PLUS'::character varying, 'XD_50PLUS'::character varying, 'XD_60PLUS'::character varying, 'XD_70PLUS'::character varying])::text[])),
    unique (user_tournament_id, game_category)
);

alter table public.registered_category
    owner to postgres;

create table if not exists public.users_roles
(
    role_id integer not null
        constraint fkj6m8fwv7oqv74fcehir1a9ffy
            references public.roles,
    user_id bigint  not null
        constraint fk2o0jvgh89lemvvo17cbqvdxaa
            references public.users
);

alter table public.users_roles
    owner to postgres;

